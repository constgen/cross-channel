{"version":3,"sources":["../src/utils/create-noop.js","../src/types/handler.js","../src/types/handlers-collection.js","../src/types/message-event.js","../src/types/message.js","../src/utils/generate-random-key.js","../src/utils/get-all-child-windows.js","../src/utils/environment.js","../src/channel/postmessage.transport.js","../src/channel/channel.js","../src/index.js"],"names":["module","exports","createNoop","Handler","callback","identifier","next","undefined","prev","prototype","call","event","HandlersCollection","head","tail","Symbol","handle","handler","push","last","remove","empty","MessageEvent","config","message","data","JSON","parse","err","console","error","Object","defineProperties","value","writable","timeStamp","key","create","self","constructor","Message","asJSON","stringify","generateRandomKey","Math","round","random","pow","getAllChildWindows","topWin","windows","frames","win","i","length","concat","nodeGlobal","browserWindow","window","location","global","top","isNodeJs","__dirname","environment","Transport","port","origin","listeners","send","index","topBrowserWindow","browserFrames","postMessage","onMessageEvent","transport","listener","messageEvent","addEventListener","close","removeEventListener","Channel","id","CrossChannel","name","crosschannel","arguments","TypeError","String","onmessage","closed","messageHandlers","channel","on","type","removeAllListeners","once","removeHandler","valueOf"],"mappings":"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","file":"cross-channel.js"}